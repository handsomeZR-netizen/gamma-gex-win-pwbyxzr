# Gamma GEX Scalper - 项目总结

## 📋 项目概述

**项目名称**: Gamma GEX Scalper  
**项目类型**: 0DTE 期权自动交易系统  
**支持指数**: SPX (标普500), NDX (纳斯达克100)  
**策略类型**: 基于 Gamma 暴露（GEX）的均值回归策略  

---

## 🎯 核心策略

### GEX Pin 效应

期权市场的 Gamma 暴露会在特定价格点（GEX Pin）形成"引力"，价格倾向于向该点靠拢。

**交易逻辑**:
- 价格 > Pin → 卖出 Call Spread（看跌）
- 价格 < Pin → 卖出 Put Spread（看涨）
- 价格 ≈ Pin → 卖出 Iron Condor（中性）

### 风险管理

- **止损**: 10% 自动止损
- **止盈**: 50% 自动止盈
- **持有到期**: 利润 > 80% 时持有到期（最大化收益）
- **仓位管理**: Half-Kelly 公式动态调整

---

## 📊 历史表现

### 1年回测结果（$25,000 起始资金）

| 指数 | 最终余额 | ROI | 胜率 | 盈亏比 | 平均盈利 |
|------|---------|-----|------|--------|---------|
| **NDX** | $290,076 | +1,060% | 87.6% | 10.36 | $325.64 |
| **SPX** | $110,551 | +342% | 90.8% | 5.55 | $111.74 |

**结论**: NDX 收益是 SPX 的 3.1 倍

### 180天完整回测（含仓位管理）

- **总交易**: 856 笔
- **胜率**: 48.8%
- **总盈利**: $301,179
- **止损次数**: 430 次（-$48k）
- **止盈次数**: 127 次（+$55k）
- **持有到期**: 260 次（+$261k，占 87% 利润）

---

## 🛠️ 技术架构

### 核心文件

```
scalper.py              # 主交易程序（入场逻辑）
monitor.py              # 持仓监控（出场逻辑）
config.py               # 环境配置
index_config.py         # 指数配置
```

### 核心模块

```
core/
├── gex_strategy.py                 # GEX 策略逻辑
└── broken_wing_ic_calculator.py    # 不对称 IC 计算
```

### 辅助模块

```
autoscaling.py                  # Half-Kelly 仓位管理
decision_logger.py              # 决策日志
discord_autodelete.py           # Discord 通知
claude_anomaly_integration.py   # AI 异常检测
market_veto_cache.py           # 市场过滤缓存
```

---

## 🔧 运行要求

### 系统要求

- **操作系统**: Linux (Ubuntu/Debian 推荐)
- **Python**: 3.8+
- **内存**: 2GB+
- **磁盘**: 10GB+（含数据库）

### API 要求

1. **Tradier API** (必需)
   - Sandbox 账户（模拟交易）
   - Live 账户（实盘交易）
   - 费用: 免费（需开户）

2. **Discord Webhook** (可选)
   - 用于交易提醒
   - 费用: 免费

3. **Healthcheck.io** (可选)
   - 用于系统监控
   - 费用: 免费套餐

### Python 依赖

```bash
pip3 install yfinance pandas requests pytz
```

---

## 🚀 快速开始

### 1. 配置环境变量

```bash
# 创建配置文件
sudo nano /etc/gamma.env

# 添加 API 密钥
export TRADIER_SANDBOX_KEY="你的密钥"
export TRADIER_LIVE_KEY="你的密钥"
export TRADIER_PAPER_ACCOUNT_ID="账户ID"
export TRADIER_LIVE_ACCOUNT_ID="账户ID"

# 加载配置
source /etc/gamma.env
```

### 2. 运行模拟交易

```bash
# SPX 模拟
python3 scalper.py SPX PAPER

# NDX 模拟（推荐）
python3 scalper.py NDX PAPER
```

### 3. 监控持仓

```bash
python3 monitor.py PAPER
```

---

## 📈 优化特性

### 2026-01-14 部署的优化

1. **时间过滤**: 只在 10:00-13:00 ET 交易（最佳时段）
2. **VIX 下限**: VIX >= 13（避免低波动）
3. **RSI 范围**: 40-80（避免极端市场）
4. **BWIC**: 不对称 IC（根据 GEX 极性调整）

### 额外过滤器

- **VIX 飙升检测**: 5分钟内涨幅 > 5% 跳过
- **实际波动率**: 30分钟内波动 > 2.5倍基准跳过
- **市场动量**: 5分钟内移动 > 10点跳过
- **缺口过滤**: 隔夜缺口 > 0.5% 跳过
- **AI 异常检测**: Claude API 检测异常市场

---

## 📁 文件结构

### 推荐结构（整理后）

```
gamma-gex-scalper-main/
├── README.md                    # 主文档
├── requirements.txt             # Python 依赖
├── scalper.py                   # 主程序
├── monitor.py                   # 监控程序
├── config.py                    # 配置
├── index_config.py              # 指数配置
├── autoscaling.py               # 仓位管理
├── decision_logger.py           # 决策日志
├── discord_autodelete.py        # Discord 通知
├── claude_anomaly_integration.py # AI 检测
├── market_veto_cache.py         # 市场过滤
│
├── core/                        # 核心模块
│   ├── __init__.py
│   ├── gex_strategy.py
│   └── broken_wing_ic_calculator.py
│
├── data/                        # 数据目录
│   ├── orders_paper.json        # 模拟持仓
│   ├── orders_live.json         # 实盘持仓
│   ├── trades.csv               # 交易记录
│   └── *.log                    # 日志文件
│
└── docs/                        # 文档目录
    ├── 快速开始指南.md
    ├── 文件清理指南.md
    ├── 项目总结.md
    ├── guides/                  # 使用指南
    ├── reports/                 # 回测报告
    ├── analysis/                # 分析文档
    └── deployment/              # 部署文档
```

---

## 🗑️ 可删除文件

### 回测输出（可重新生成）

```bash
# 删除所有回测结果
rm -f *backtest*.txt *backtest*.csv *backtest*.json
rm -f *.png
```

### 测试/分析脚本（一次性使用）

```bash
# 删除测试脚本
rm -f test_*.py debug_*.py analyze_*.py optimize_*.py
```

### 旧版本脚本（已废弃）

```bash
# 删除旧版回测
rm -f backtest_gex_*.py backtest_otm_*.py backtest_realistic_*.py
```

**详细清理指南**: 参见 `docs/文件清理指南.md`

---

## 📚 重要文档

### 必读文档

1. **快速开始指南.md** - 如何运行项目
2. **文件清理指南.md** - 如何整理文件
3. **README.md** - 项目主文档

### 技术文档

4. **DEPLOYMENT_VALIDATION_2026_01_14.txt** - 部署验证
5. **COMPREHENSIVE_BACKTEST_FINAL_REPORT.txt** - 完整回测报告
6. **START_HERE_2026_01_14.md** - 2026-01-14 部署总结

---

## 🎓 学习路径

### 第1天: 了解项目

1. 阅读 `快速开始指南.md`
2. 了解 GEX 策略原理
3. 查看回测结果

### 第2-3天: 配置环境

1. 注册 Tradier 账户
2. 配置环境变量
3. 安装 Python 依赖

### 第4-7天: 模拟交易

1. 运行 SPX 模拟交易
2. 运行 NDX 模拟交易
3. 观察交易信号和执行

### 第2周: 数据收集

1. 收集 10-15 笔交易
2. 分析胜率和盈亏
3. 验证过滤器工作

### 第3-4周: 统计验证

1. 收集 30-50 笔交易
2. 运行统计检验
3. 对比回测结果

### 第5周+: 实盘准备

1. 如果模拟表现良好（胜率 > 40%）
2. 小资金实盘测试
3. 逐步增加仓位

---

## ⚠️ 风险提示

### 市场风险

- 0DTE 期权波动大，可能快速亏损
- 历史表现不代表未来收益
- 市场异常时策略可能失效

### 技术风险

- API 故障可能导致无法交易
- 网络中断可能错过止损
- 系统故障可能导致持仓失控

### 资金管理

- **建议起始资金**: $25,000+
- **单笔最大风险**: 账户的 2-5%
- **最大回撤容忍**: 20%

### 监控要求

- **每日检查**: 持仓状态、系统日志
- **每周检查**: 胜率、盈亏、过滤器效果
- **每月检查**: 整体表现、策略调整

---

## 🔮 未来改进

### 短期（1-3个月）

- [ ] 添加更多指数（RUT, DJX）
- [ ] 优化 NDX 特定参数
- [ ] 改进 AI 异常检测

### 中期（3-6个月）

- [ ] 动态指数选择（根据波动率）
- [ ] 跨指数对冲策略
- [ ] 实时性能仪表板

### 长期（6-12个月）

- [ ] 机器学习优化参数
- [ ] 多策略组合
- [ ] 风险平价配置

---

## 📞 获取帮助

### 查看日志

```bash
# 交易日志
tail -50 data/trades.csv

# 监控日志
tail -50 data/monitor_paper.log

# 系统日志
journalctl -u gamma-monitor-paper -n 50
```

### 常见问题

1. **401 错误**: 检查 API 密钥配置
2. **没有交易**: 检查过滤器（VIX, RSI, 时间）
3. **持仓未平**: 检查监控服务是否运行

### 验证配置

```bash
# 检查环境变量
echo $TRADIER_SANDBOX_KEY

# 检查优化参数
grep "CUTOFF_HOUR\|VIX_FLOOR" scalper.py

# 测试运行
python3 scalper.py SPX PAPER 6000 6050
```

---

## 📊 性能指标

### 目标指标

- **胜率**: 40-50%
- **盈亏比**: 2:1 以上
- **月收益**: 5-15%
- **最大回撤**: < 20%
- **夏普比率**: > 1.5

### 监控指标

- **每日交易数**: 0-3 笔
- **平均持仓时间**: 2-6 小时
- **止损触发率**: < 30%
- **止盈触发率**: 10-20%
- **持有到期率**: 50-70%

---

## 🏆 最佳实践

### 交易纪律

1. **严格遵守过滤器**: 不手动干预
2. **信任止损**: 不移动止损位
3. **耐心等待**: 不强求每天交易
4. **记录复盘**: 每周回顾交易

### 资金管理

1. **分散投资**: 不要全仓单一策略
2. **逐步加仓**: 验证后再增加资金
3. **保留现金**: 至少 20% 现金储备
4. **定期提现**: 盈利后定期提取

### 系统维护

1. **每日检查**: 系统运行状态
2. **每周备份**: 数据和配置
3. **每月更新**: Python 依赖和系统
4. **季度审计**: 策略表现和参数

---

## 📝 版本历史

### v1.0.0 (2026-01-14)

- ✅ 核心 GEX 策略实现
- ✅ SPX 和 NDX 支持
- ✅ 自动仓位管理
- ✅ 完整风险控制
- ✅ Discord 通知集成

### v1.1.0 (2026-01-14)

- ✅ 时间过滤优化（10:00-13:00）
- ✅ VIX 下限提升（13.0）
- ✅ RSI 强制执行
- ✅ BWIC 集成

### v1.2.0 (计划中)

- [ ] 更多指数支持
- [ ] 改进 AI 检测
- [ ] 性能仪表板

---

## 📄 许可和免责声明

### 使用许可

本项目仅供学习和研究使用。

### 免责声明

- 期权交易有风险，可能损失全部本金
- 本项目不构成投资建议
- 使用者需自行承担交易风险
- 作者不对任何损失负责

### 风险警告

**期权交易风险极高，不适合所有投资者。在使用本系统前，请确保：**

1. 充分理解期权交易风险
2. 具备足够的风险承受能力
3. 不使用借贷资金交易
4. 做好可能损失全部本金的准备

---

**创建日期**: 2026-02-06  
**最后更新**: 2026-02-06  
**版本**: 1.0  
**状态**: 生产就绪
