# 文件清理指南

## 可以安全删除的文件

### 1. 回测输出文件（可删除，需要时重新生成）

```bash
# 回测结果文件
5year_backtest_output.txt
ndx_5year_backtest_output.txt
ndx_montecarlo_10k_output.txt
multi_index_output.txt
SPX_vs_NDX_1year_comparison.txt

# 回测 CSV 文件
backtest_*.csv
credit_spreads_backtest.csv
multi_index_comparison.csv

# 回测 JSON 结果
bwic_backtest_results_*.json
fixed_results.json
slippage_results.json
MONTE_CARLO_RESULTS.json
detailed_test.json

# 回测图表
MONTE_CARLO_DISTRIBUTION.png
progressive_hold_comparison.png
```

### 2. 临时/测试文件（可删除）

```bash
# 测试脚本
test_*.py
debug_*.py
show.py
show_improved_gex_trades.py

# 分析脚本（一次性使用）
analyze_*.py
optimize_*.py
validate_*.py
verify_*.py
visualize_*.py

# 检查脚本
check_*.py
strike_conflict_checker.py
```

### 3. 旧版本/废弃文件（可删除）

```bash
# 旧版回测脚本
backtest.py
backtest_gex_*.py
backtest_otm_*.py
backtest_realistic_*.py
backtest_with_*.py
gamma_backtest_ab_test.py
gamma_OTM_BACKTEST.py
gamma_CANONICAL_BACKTEST.py

# 旧版数据收集器
data_collector.py
collect_0dte_*.py
download_*.py
import_databento_*.py
extract_0dte_from_existing_db.py

# 旧版监控
monitor_gamma_crashes.py
track_performance.py
```

### 4. 文档/报告文件（可移动到 docs/ 目录）

```bash
# Markdown 文档（保留但移动）
*.md

# 文本报告（保留但移动）
*.txt（除了 requirements.txt）
```

### 5. 配置/服务文件（根据需要保留）

```bash
# Systemd 服务文件（如果不用 systemd 可删除）
systemd-*.service

# Shell 脚本（如果不用可删除）
*.sh
```

---

## 必须保留的核心文件

### 1. 主程序文件（必需）

```
scalper.py              # 主交易程序
monitor.py              # 持仓监控
config.py               # 配置文件
index_config.py         # 指数配置
```

### 2. 核心模块（必需）

```
core/
├── __init__.py
├── gex_strategy.py                 # GEX 策略逻辑
└── broken_wing_ic_calculator.py    # BWIC 计算器
```

### 3. 辅助模块（必需）

```
decision_logger.py              # 决策日志
discord_autodelete.py           # Discord 通知
claude_anomaly_integration.py   # AI 异常检测
autoscaling.py                  # 仓位管理
market_veto_cache.py           # 市场过滤缓存
```

### 4. 数据目录（必需）

```
data/
├── .gitkeep
├── orders_paper.json          # 模拟持仓
├── orders_live.json           # 实盘持仓
├── trades.csv                 # 交易记录
└── *.log                      # 日志文件
```

### 5. 重要文档（保留）

```
README.md                      # 主文档
START_HERE_2026_01_14.md      # 快速开始
DEPLOYMENT_VALIDATION_*.txt    # 部署验证
```

---

## 清理命令

### 安全清理（推荐）

```bash
cd gamma-gex-scalper-main

# 创建备份
mkdir -p ../gamma-backup
cp -r . ../gamma-backup/

# 删除回测输出
rm -f *backtest*.txt *backtest*.csv *backtest*.json
rm -f 5year_*.txt ndx_*.txt multi_index_*.txt SPX_vs_NDX_*.txt

# 删除测试文件
rm -f test_*.py debug_*.py analyze_*.py optimize_*.py validate_*.py verify_*.py

# 删除旧版脚本
rm -f backtest_gex_*.py backtest_otm_*.py backtest_realistic_*.py backtest_with_*.py
rm -f gamma_backtest_*.py gamma_OTM_*.py gamma_CANONICAL_*.py

# 删除图表
rm -f *.png

# 删除临时文件
rm -f *.deb
```

### 激进清理（谨慎使用）

```bash
# 删除所有 .md 文档（除了 README.md）
find . -name "*.md" ! -name "README.md" -delete

# 删除所有 .txt 报告
find . -name "*.txt" -delete

# 删除所有回测脚本
rm -f backtest_*.py

# 删除所有分析脚本
rm -f analyze_*.py optimize_*.py test_*.py debug_*.py
```

---

## 文档整理建议

### 创建文档目录结构

```bash
mkdir -p docs/{guides,reports,analysis,deployment}

# 移动文档
mv *.md docs/
mv *REPORT*.txt docs/reports/
mv *ANALYSIS*.txt docs/analysis/
mv *DEPLOYMENT*.txt docs/deployment/
mv *GUIDE*.md docs/guides/

# 保留根目录的 README.md
cp docs/README.md ./README.md
```

### 推荐的目录结构

```
gamma-gex-scalper-main/
├── README.md                    # 主文档（保留在根目录）
├── scalper.py                   # 主程序
├── monitor.py                   # 监控程序
├── config.py                    # 配置
├── index_config.py              # 指数配置
├── autoscaling.py               # 仓位管理
├── decision_logger.py           # 决策日志
├── discord_autodelete.py        # Discord 通知
├── claude_anomaly_integration.py # AI 检测
├── market_veto_cache.py         # 市场过滤
│
├── core/                        # 核心模块
│   ├── __init__.py
│   ├── gex_strategy.py
│   └── broken_wing_ic_calculator.py
│
├── data/                        # 数据目录
│   ├── .gitkeep
│   ├── orders_paper.json
│   ├── orders_live.json
│   ├── trades.csv
│   └── *.log
│
├── docs/                        # 文档目录
│   ├── 快速开始指南.md
│   ├── 文件清理指南.md
│   ├── guides/                  # 使用指南
│   ├── reports/                 # 回测报告
│   ├── analysis/                # 分析文档
│   └── deployment/              # 部署文档
│
└── archive/                     # 归档（旧文件）
    ├── old_backtests/
    ├── old_scripts/
    └── deprecated/
```

---

## 执行清理

### 步骤 1: 备份

```bash
# 完整备份
cd ..
tar -czf gamma-backup-$(date +%Y%m%d).tar.gz gamma-gex-scalper-main/

# 验证备份
tar -tzf gamma-backup-$(date +%Y%m%d).tar.gz | head -20
```

### 步骤 2: 创建目录结构

```bash
cd gamma-gex-scalper-main

# 创建新目录
mkdir -p docs/{guides,reports,analysis,deployment}
mkdir -p archive/{old_backtests,old_scripts,deprecated}
```

### 步骤 3: 移动文件

```bash
# 移动文档
mv *GUIDE*.md *README*.md docs/guides/ 2>/dev/null
mv *REPORT*.txt *SUMMARY*.txt docs/reports/ 2>/dev/null
mv *ANALYSIS*.md *INVESTIGATION*.txt docs/analysis/ 2>/dev/null
mv *DEPLOYMENT*.md *VALIDATION*.txt docs/deployment/ 2>/dev/null

# 移动旧脚本到归档
mv backtest_*.py archive/old_backtests/ 2>/dev/null
mv test_*.py debug_*.py analyze_*.py archive/old_scripts/ 2>/dev/null

# 保留 README.md 在根目录
cp docs/README.md ./README.md 2>/dev/null
```

### 步骤 4: 删除临时文件

```bash
# 删除回测输出
rm -f *backtest*.csv *backtest*.json
rm -f *.png

# 删除临时文件
rm -f *.deb
rm -f alpaca_0dte_checkpoint.json
rm -f gex_blackbox.db
```

### 步骤 5: 验证核心文件

```bash
# 确认核心文件存在
ls -la scalper.py monitor.py config.py index_config.py
ls -la core/
ls -la data/
```

---

## 清理后的预期结果

### 文件数量对比

**清理前**: ~300+ 文件  
**清理后**: ~30-40 核心文件 + 文档目录

### 磁盘空间

**清理前**: ~500-800 MB  
**清理后**: ~50-100 MB（不含数据库）

### 目录清晰度

- ✅ 根目录只有核心程序文件
- ✅ 文档整理到 docs/ 目录
- ✅ 旧文件归档到 archive/ 目录
- ✅ 数据文件在 data/ 目录

---

## 注意事项

1. **始终先备份**：执行任何删除操作前先备份
2. **保留数据库**：不要删除 `data/` 目录下的 `.db` 文件
3. **保留日志**：最近的日志文件可能有用
4. **测试运行**：清理后测试程序是否正常运行

```bash
# 测试运行
python3 scalper.py SPX PAPER 6000 6050
```

5. **Git 管理**：如果使用 Git，考虑 `.gitignore`

```bash
# 创建 .gitignore
cat > .gitignore << EOF
# 数据文件
data/*.json
data/*.csv
data/*.log
data/*.db

# 回测输出
*backtest*.csv
*backtest*.json
*.png

# Python 缓存
__pycache__/
*.pyc
*.pyo

# 临时文件
*.tmp
*.bak
EOF
```

---

**创建日期**: 2026-02-06  
**用途**: 清理项目文件，保持目录整洁  
**状态**: 可立即执行
